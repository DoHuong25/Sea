<div class="bg-white rounded-2xl shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300 flex flex-col">
    <a href="/foods/<%= food._id %>">
        <img src="<%= food.image %>" alt="<%= food.name %>" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x300/e2e8f0/64748b?text=Image+Error';">
    </a>
    <div class="p-5 flex flex-col flex-grow">
        <h3 class="font-bold text-lg mb-2 truncate"><a href="/foods/<%= food._id %>" class="hover:text-red-600"><%= food.name %></a></h3>
        <div class="flex items-center text-sm text-gray-500 mb-3">
            <i class="fas fa-map-marker-alt mr-2 text-red-500"></i>
            <span><%= food.province %></span>
        </div>
        <%
            let totalStars = 0;
            if (food.ratings && food.ratings.length > 0) {
                food.ratings.forEach(rating => { totalStars += rating.stars; });
            }
            const averageRating = food.ratings.length > 0 ? totalStars / food.ratings.length : 0;
        %>
        <div class="flex items-center text-sm mb-4">
            <!-- Logic hiển thị sao -->
            <% for(let i = 1; i <= 5; i++) { %>
                <% if(averageRating >= i) { %>
                    <i class="fas fa-star text-yellow-400"></i>
                <% } else if (averageRating >= i - 0.5) { %>
                    <i class="fas fa-star-half-alt text-yellow-400"></i>
                <% } else { %>
                    <i class="far fa-star text-yellow-400"></i>
                <% } %>
            <% } %>
            <span class="ml-2 text-gray-600">(<%= food.ratings.length %> đánh giá)</span>
        </div>
        <div class="mt-auto">
           <a href="/foods/<%= food._id %>" class="block text-center w-full bg-red-500 text-white px-4 py-2 rounded-full font-semibold hover:bg-red-600 transition">Xem Chi Tiết</a>
        </div>
    </div>
</div>